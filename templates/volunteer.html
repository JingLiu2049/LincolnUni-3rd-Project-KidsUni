{%extends "layout.html"%}
{%block title%}
{%endblock%}
{%block head%}
<link rel="stylesheet" href="{{url_for('static', filename = 'volunteer.css')}}">

{%endblock%}
{% block current_user %}{{ name[0] }} {{ name[1] }} {% endblock current_user %}
{%block content%}
<main class="m-4">
    <h1>volunteer page</h1>
    <form action="/volunteer_upload" method="POST" enctype="multipart/form-data">
        <input type="file" id="file" name="file">
        <button type="submit" id="btn">submit</button>
    </form>
    <form action="/volunteer" method="POST" class="criteria clearfix">
        {% for i in criteria.keys()%}
        <div class="each">
        <span>
            {{i}}:
        </span>
            {%for j in criteria[i]%}
            <label for="{{j[0]}}">{{j[0]}}</label> <input type="checkbox" name="{{i}}" id="{{j[0]}}" value="{{j[0]}}">
            {%endfor%}
        </div>
        {%endfor%}
        <button type="submit">Submit</button>
        <button><a href="/volunteer">Reset</a></button>
    </form>
    <table class="table">
        <thead>
            <tr>
                <td>ID</td>
                <td>Status</td>
                <td>Induction</td>
                <td>Interview</td>
                <td>Name</td>
                <td>Gender</td>
                <td>Volunteer Experience</td>
                <td>Future Leader</td>
                <td>Police Check</td>
                <td>University</td>
                <td>Course</td>
                <td>Current Year</td>
                <td>Completion Date</td>
            </tr>
        </thead>
        {%for i in voluns%}
        <tr>
            <td><a href="javascript:;" class="volunid">{{i.id}}</a></td>
            <td>{{i.status}}</td>
            <td>{{i.induction}}</td>
            <td>{{i.interview}}</td>
            <td>{{i.firstname}} {{i.surname}}</td>
            <td>{{i.gender}}</td>
            <td>{{i.experience}}</td>
            <td>{{i.leader}}</td>
            <td>{{i.police}}</td>
            <td>{{i.uni}}</td>
            <td>{{i.course}}</td>
            <td>{{i.current_year}}</td>
            <td>{{i.comp_date}}</td>
        </tr>
        {%endfor%}
    </table>
    <div class="form_wrap hidden" id="showDetail">
        {% for i in voluns%}
        <div id="{{i.id}}" class="details hidden">
            <form action="javascrip:;">
                <label for="id{{i.id}}">ID</label> <input type="text" value="{{i.id}}" readonly id="id{{i.id}}">
                <label for="status{{i.id}}">Status</label> <input type="text" value="{{i.status}}" id="status{{i.id}}">
                <button type="submit" class="btn btn-outline-primary">Submit</button>
                <button type="reset" class="btn btn-outline-primary">Reset</button>
            </form>
        </div>
        {% endfor %}
        <button type="button" class="btn btn-outline-primary" id="close">Close</button>
    </div>
</main>

<script type="text/javascript">
    var closeBtn = document.getElementById("close");
    var showDetail = document.getElementById("showDetail");
    var id_list = document.getElementsByClassName("volunid")
    var details = document.getElementsByClassName("details")
    function closeForm() {
        for (var i = 0; i < details.length; i++) {
            if (!hasClass(i, 'hidden')) {
                addClass(i, 'hidden');
            }
        }
        addClass(showDetail, 'hidden');
    }
    document.body.addEventListener("click", function (e) {
        test(id_list)
        if (!hasClass(showDetail, 'hidden')) {
            test(e.target)
        }
    }, false)
    for (var i = 0; i < id_list.length; i++) {
        id_list[i].addEventListener("click", function () {

            let select = document.getElementById(this.innerHTML)
            removeClass(showDetail, 'hidden')
            removeClass(select, 'hidden')
        }, false)
    }

    closeBtn.addEventListener("click", closeForm, false)

</script>
{%endblock%}